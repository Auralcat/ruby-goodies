#!/usr/bin/env ruby

# The idea here is to generate a CSS file from a HTML file.
# We'll use Nokogiri to do the parsing
require 'nokogiri'

def extract_classes(html_file)
  # Returns an array with single occurrences of
  # the classes found in the document
  out = []
  html_file.css('*').each do |element|
    class_string = element.attr('class')
    out.concat(class_string.split(' ')) unless class_string.nil?
  end
  out.uniq.reject { |x| x == '' }
end

# Open local file using Nokogiri
html_file = Nokogiri::HTML(ARGF.read)

# Put all found classes in here
html_classes = extract_classes(html_file)

# Write CSS class body
output = "/* This CSS code has been generated by css_primer.rb */\n\n"
html_classes.each do |item|
  output += ".#{item} {\n\n}\n\n"
end

# Write this to standard output.
# The user may write this to a file if they wish later.
puts output
